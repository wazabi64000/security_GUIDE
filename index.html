<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>Sécuriser une API Express Moderne</title>
<link rel="stylesheet" href="style.css">
</head>
<body>
  <nav style="background:#007acc; padding:10px;">
  <a href="index.html" style="color:#fff; text-decoration:none; margin-right:15px;">Accueil</a>
  <a href="helmet.html" style="color:#fff; text-decoration:none; margin-right:15px;">Helmet</a>
  <a href="rate-limit.html" style="color:#fff; text-decoration:none; margin-right:15px;">Rate Limit</a>
  <a href="cors.html" style="color:#fff; text-decoration:none; margin-right:15px;">CORS</a>
  <a href="joi.html" style="color:#fff; text-decoration:none; margin-right:15px;">Joi</a>
  <a href="csurf.html" style="color:#fff; text-decoration:none; margin-right:15px;">CSRF</a>
  <a href="xss-clean.html" style="color:#fff; text-decoration:none; margin-right:15px;">XSS Clean</a>
  <a href="express-session.html" style="color:#fff; text-decoration:none; margin-right:15px;">Sessions</a>
  <a href="jsonwebtoken.html" style="color:#fff; text-decoration:none; margin-right:15px;">JWT</a>
  <a href="bcrypt.html" style="color:#fff; text-decoration:none; margin-right:15px;">Bcrypt</a>
  <a href="mongoose.html" style="color:#fff; text-decoration:none; margin-right:15px;">Mongoose</a>
  <a href="mysql2.html" style="color:#fff; text-decoration:none; margin-right:15px;">MySQL2</a>
  <a href="winston.html" style="color:#fff; text-decoration:none;">Winston</a>
</nav>

  <header>
    <h1>Guide de Sécurisation API Express</h1>
    <p>Modules modernes, simples et efficaces</p>
  </header>

  <main>
    <section>
      <h2>Modules de sécurité essentiels</h2>
      <table>
        <thead>
          <tr>
            <th>Besoin</th>
            <th>Module</th>
            <th>Rôle</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>Headers HTTP sécurisés</td>
            <td><code>helmet</code></td>
            <td>Protection XSS, clickjacking</td>
          </tr>
          <tr>
            <td>Limiter les requêtes</td>
            <td><code>express-rate-limit</code></td>
            <td>Contre les attaques brute-force</td>
          </tr>
          <tr>
            <td>Origines autorisées</td>
            <td><code>cors</code></td>
            <td>Bloque les origines inconnues</td>
          </tr>
          <tr>
            <td>Validation</td>
            <td><code>express-validator</code></td>
            <td>Valide et nettoie les données</td>
          </tr>
          <tr>
            <td>XSS (entrée utilisateur)</td>
            <td><code>xss-clean</code></td>
            <td>Supprime le code malveillant</td>
          </tr>
        </tbody>
      </table>
    </section>

    <section>
      <h2>Exemple de code sécurisé</h2>
      <pre><code>const express = require('express');
const helmet = require('helmet');
const cors = require('cors');
const rateLimit = require('express-rate-limit');
const xss = require('xss-clean');
const { body, validationResult } = require('express-validator');

const app = express();
app.use(helmet());
app.use(cors({ origin: 'https://tonsite.com' }));
app.use(express.json());
app.use(xss());
app.use(rateLimit({ windowMs: 15 * 60 * 1000, max: 100 }));

app.post('/login',
  body('email').isEmail(),
  body('password').isLength({ min: 8 }),
  (req, res) => {
    const errors = validationResult(req);
    if (!errors.isEmpty()) return res.status(400).json({ errors: errors.array() });
    // Authentifier ici
  });

app.listen(3000);</code></pre>
    </section>

<section>
  <h2>Conseils supplémentaires</h2>
  <ul>
    <li>
      <strong>Utiliser <code>npm audit</code> régulièrement</strong>  
      <p>Exécutez cette commande pour détecter et corriger les vulnérabilités dans vos dépendances. Cela permet de maintenir votre projet à jour et sécurisé.</p>
    </li>
    <li>
      <strong>Ne jamais afficher les erreurs serveur en production</strong>  
      <p>Pour éviter de révéler des informations sensibles aux utilisateurs ou attaquants, configurez votre application pour ne montrer que des messages génériques en cas d’erreur, et logguez les détails côté serveur.</p>
    </li>
    <li>
      <strong>Limiter les droits sur la base de données</strong>  
      <p>Attribuez uniquement les permissions nécessaires à vos utilisateurs ou services. Par exemple, un compte de lecture ne doit pas avoir de droits d’écriture. Ceci réduit les risques en cas de compromission.</p>
    </li>
    <li>
      <strong>Utiliser HTTPS avec redirection automatique</strong>  
      <p>Chiffrez les échanges entre clients et serveur pour éviter les interceptions (man-in-the-middle). Configurez le serveur pour rediriger toutes les requêtes HTTP vers HTTPS automatiquement.</p>
    </li>
  </ul>
</section>

<footer style="margin-top:40px; padding:10px; border-top:1px solid #ccc; text-align:center; font-size:0.9em; color:#555;">
  <p>Guide réalisé pour d'amuser</p>
</footer>

</body>
</html>
